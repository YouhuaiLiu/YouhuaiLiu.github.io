<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" integrity="sha256-5eIC48iZUHmSlSUz9XtjRyK2mzQkHScZY1WdMaoz74E=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Gemini","darkmode":true,"version":"8.21.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>

    <meta property="og:type" content="website">
<meta property="og:title" content="Blog of Youhuai Liu">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="Blog of Youhuai Liu">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Youhuai Liu">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://example.com/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Blog of Youhuai Liu</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Blog of Youhuai Liu</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Youhuai Liu</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">4</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">分类</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/Hoedgepodge%20Pod/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Youhuai Liu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blog of Youhuai Liu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Blog of Youhuai Liu">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/Hoedgepodge%20Pod/" class="post-title-link" itemprop="url">Hoedgepodge Pod</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2024-11-24 15:49:03 / 修改时间：19:53:07" itemprop="dateCreated datePublished" datetime="2024-11-24T15:49:03+00:00">2024-11-24</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="UART"><a href="#UART" class="headerlink" title="UART"></a>UART</h1><h2 id="Why-UART-only-send-one-Byte-per-Frame"><a href="#Why-UART-only-send-one-Byte-per-Frame" class="headerlink" title="Why UART only send one Byte per Frame"></a>Why UART only send one Byte per Frame</h2><p>UART is a serial communication protocol, which send data bit by bit in a sequential stream. </p>
<p>Since the protocol includes additional bits to ensure reliable communication, each data byte needs it own “envelope” (frame) to be transmitted and it limit UART to send a byte per frame.</p>
<h1 id="readLine-response-5"><a href="#readLine-response-5" class="headerlink" title="readLine(response, 5)"></a>readLine(response, 5)</h1><h2 id="environment"><a href="#environment" class="headerlink" title="environment:"></a>environment:</h2><p>char response[6];</p>
<p>kl28z</p>
<p>import serialPort.c</p>
<h2 id="why-response-have-only-6-bit-array"><a href="#why-response-have-only-6-bit-array" class="headerlink" title="why response have only 6 bit array"></a>why response have only 6 bit array</h2><p>the response only expect to receive 5 bit and in C, the string need \0 at the end, which take 1 bit</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/Embedded-System/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Youhuai Liu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blog of Youhuai Liu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Blog of Youhuai Liu">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/Embedded-System/" class="post-title-link" itemprop="url">Embedded_System</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-11-16 15:15:22" itemprop="dateCreated datePublished" datetime="2024-11-16T15:15:22+00:00">2024-11-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-11-24 19:53:08" itemprop="dateModified" datetime="2024-11-24T19:53:08+00:00">2024-11-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Embedded-System/" itemprop="url" rel="index"><span itemprop="name">Embedded System</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Meaning-of-Term"><a href="#Meaning-of-Term" class="headerlink" title="Meaning of Term"></a>Meaning of Term</h1><h3 id="Integrated-Circuit-IC"><a href="#Integrated-Circuit-IC" class="headerlink" title="Integrated Circuit (IC)"></a>Integrated Circuit (IC)</h3><p>Electronic circuit with components built into a single piece of silicon, enabling extreme miniaturization, mass production, and cost reduction.</p>
<h3 id="Microcontroller-Unit-MCU"><a href="#Microcontroller-Unit-MCU" class="headerlink" title="Microcontroller Unit (MCU)"></a>Microcontroller Unit (MCU)</h3><p>Integrated circuit containing CPU, peripherals, support circuit, and often memory.</p>
<h3 id="Central-Processing-Unit-CPU"><a href="#Central-Processing-Unit-CPU" class="headerlink" title="Central Processing Unit (CPU)"></a>Central Processing Unit (CPU)</h3><p>Hardware circuit that exectues a program’s instructions.</p>
<h3 id="instruction"><a href="#instruction" class="headerlink" title="instruction"></a>instruction</h3><p>Command for processor to execute. Consists of an operation and zero or more operands.</p>
<h3 id="Printed-Circuit-Board-PCB"><a href="#Printed-Circuit-Board-PCB" class="headerlink" title="Printed Circuit Board (PCB)"></a>Printed Circuit Board (PCB)</h3><p>Board which holds electronic components and conductive traces for interconnection.</p>
<h3 id="Light-emitting-Diode-LED"><a href="#Light-emitting-Diode-LED" class="headerlink" title="Light-emitting Diode (LED)"></a>Light-emitting Diode (LED)</h3><p>tronic component which emits lights. Used for indicators, backlighting, and general illumination.</p>
<h3 id="Peripheral"><a href="#Peripheral" class="headerlink" title="Peripheral"></a>Peripheral</h3><p>Hardware that helps CPU interfacing or providing special functionality.</p>
<h3 id="Analog"><a href="#Analog" class="headerlink" title="Analog"></a>Analog</h3><p>Capable of taking on an infinite number of values</p>
<h3 id="Digital"><a href="#Digital" class="headerlink" title="Digital"></a>Digital</h3><p>Capable of taking on an infinite number of values</p>
<h3 id="Analog-to-Digital-Converter-ADC"><a href="#Analog-to-Digital-Converter-ADC" class="headerlink" title="Analog-to-Digital Converter (ADC)"></a>Analog-to-Digital Converter (ADC)</h3><p>Circuit which converts an analog value (e.g. voltage) to its corresponding digital value.</p>
<h3 id="Digital-to-Analog-Converter-DAC"><a href="#Digital-to-Analog-Converter-DAC" class="headerlink" title="Digital-to-Analog Converter (DAC)"></a>Digital-to-Analog Converter (DAC)</h3><p>Circuit which converts a digital value to its corresponding analog value (e.g. voltage)</p>
<h3 id="General-purpose-input-output-GPIO-port"><a href="#General-purpose-input-output-GPIO-port" class="headerlink" title="General-purpose input.output (GPIO) port"></a>General-purpose input.output (GPIO) port</h3><p>Peripheral with digital input and output bits</p>
<h3 id="input-GPIO-port-bit"><a href="#input-GPIO-port-bit" class="headerlink" title="input GPIO port bit"></a>input GPIO port bit</h3><p>portion of GPIO port that enables program to read a single-bit input signal</p>
<h3 id="output-GPIO-port-bit"><a href="#output-GPIO-port-bit" class="headerlink" title="output GPIO port bit"></a>output GPIO port bit</h3><p>Portion of GPIO port that enables program to read a single-bit output signal</p>
<h3 id="Transistor"><a href="#Transistor" class="headerlink" title="Transistor"></a>Transistor</h3><p>Basic electronic component which operates as switch or amplifier</p>
<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><h2 id="Typical-Embedded-System-Software-Operations"><a href="#Typical-Embedded-System-Software-Operations" class="headerlink" title="Typical Embedded System Software Operations"></a>Typical Embedded System Software Operations</h2><p>Embedded systems typically perform one or more types of operations:</p>
<h3 id="Closed-loop-control"><a href="#Closed-loop-control" class="headerlink" title="- Closed-loop control:"></a>- Closed-loop control:</h3><p>Involves controlling an output variable based on one or more input measruements</p>
<h3 id="Sequencing"><a href="#Sequencing" class="headerlink" title="- Sequencing:"></a>- Sequencing:</h3><p>Involves controlling an output through a sequence of steps.<br>e.g. Steps of icemaker</p>
<ul>
<li>fill the ice tray with water</li>
<li>chill the ice tray until the water is frozen</li>
<li>heat the ice tray to allow the ice to seperate from the tray</li>
<li>eject the ice from tray</li>
</ul>
<h3 id="Signal-Conditioning-and-processing"><a href="#Signal-Conditioning-and-processing" class="headerlink" title="- Signal Conditioning and processing"></a>- Signal Conditioning and processing</h3><p>Used to average together multiple sensor reading or filter out noise from motors or other devices<br>e.g. Quadcopter’s motor vibrate as they run, introducing noise into the acceleration and rotation readeings. Taking multiple readings and averageing them can reduce the impact of this noise </p>
<h3 id="Communication-and-networking"><a href="#Communication-and-networking" class="headerlink" title="- Communication and networking"></a>- Communication and networking</h3><p>Allow the device to interact with subsystems or other systems.<br>e.g. The quadcopter receive packets of control data sent by radio from the controller.</p>
<h2 id="Embedded-System-Attributes"><a href="#Embedded-System-Attributes" class="headerlink" title="Embedded System Attributes"></a>Embedded System Attributes</h2><h3 id="Interfacing-with-Inputs-and-Outputs"><a href="#Interfacing-with-Inputs-and-Outputs" class="headerlink" title="Interfacing with Inputs and Outputs"></a>Interfacing with Inputs and Outputs</h3><p>Embedded computers typically need to sense the environment and then control devices in response. To do this, MCU consist of a CPU surrounded by specialized peripheral hardware circuit that perform much of this interfacing.</p>
<p>Many external devices use analog sifnals in which the voltage can take on a continuouse range of value to convey information (e.g. temperature sensor indicate its reading by setting its output signal.s voltage to 0.05V&#x2F;C). The analog signal must be converted into digital value for the program to process it, which is done by analog-to-digital converter.</p>
<p>Correspondingly, to generate sounds accurately, MCU must generate analog voltage signal to drive devices, which is done by digital-to-analog converter.</p>
<p>For CPU to handle the input, signals should be processed like amplifying weak signals, sdcalling down high-voltage signal, filtering noises, etc. Also, MCU cannot drive power-hungry devices so it needs amolification. </p>
<p>This also protects circuit by isolating low-voltage components from main voltage.</p>
<h3 id="Concurrency"><a href="#Concurrency" class="headerlink" title="Concurrency"></a>Concurrency</h3><p>Embedded controllers must typically manage multiple activities concottrenly, often with precise control of the timing.</p>
<p>To achieve this, MCU shareing the CPU among different parts of the software, and also by performing some processing in hardware peripherals that run independently of the CPU.</p>
<p>The scheduler determines what pieve of software to run next on the processor and switches execution context as needed to make it happen correctly. </p>
<p>The most basic shcedulers are simple to use and impose little overhead on the processor. It work best for simple systems and only provide limited help to the developer. </p>
<p>Advanced schedulers provide better responsiveness andmore fearture to help in program development, which real-time operating systems typically use (e.g. RTX from Keil). But it require more processor’s time and memory.</p>
<h3 id="Responsiveness"><a href="#Responsiveness" class="headerlink" title="Responsiveness"></a>Responsiveness</h3><p>Embedded system requires make responses in limited time.</p>
<p>There are two aspects to make a system responsive: raw processing speed and task scheduling </p>
<p>First, the processor should be fast enough to complete the critical processing before its deadline.</p>
<p>To achieve this, there are two approach. One is make the code efficient (Optimization), another is use a fast processor.</p>
<p>However, there is a problem that optimizing code will increase the development cost while recurring per-unit cost. Using a faster processor is more expensive and it may also requrie more careful circuit design methods.</p>
<p>One the processor exceeds 50MHz, the flash memory will not be able to keep up, forcing CPU desginer to modify the momory system to hide this delay.</p>
<p>Second, processor need to stay focused on the critical processing rather than being distracted by other processing. If possible, critical processing should be performed by harware peripherals to prevent any software interference.</p>
<p>Otherwise, some kind of software scheduling approach is needed (using simple sheduling approches or system use interrupts and preemptive scheduler).</p>
<p>Some such high process demand embedded systems use multicore processors or multiple single-core processors to get higher performance.</p>
<p>Some embedded systems use multiple processors to simplify design, rather than to get raw processing speed. Separating the processing reduces timing interference among the software components. Many commercial off-the-shelf modules contain an integreated MCU to work.</p>
<h3 id="Reliability-and-Fault-Handling"><a href="#Reliability-and-Fault-Handling" class="headerlink" title="Reliability and Fault Handling"></a>Reliability and Fault Handling</h3><p>Embedded system are expected to work correctly and reliably because it does not expect user to reboot it. If something fails, the system should minimize the impact of that failure rather than cause further problems. </p>
<p>Solution might depend on application. There may be method to detect actual or impending and shut down system before trouble occur (thermal sensor to detect overheating, current sensor to detect short-circuited output), the circuit can be designed in a way to make failures easy to detect in software, or be able to analyze historical data to determine failures.</p>
<h3 id="Constraints"><a href="#Constraints" class="headerlink" title="Constraints"></a>Constraints</h3><p>When designer designs embedded system, it require to not be too expensive, large, heacy, power-hungry, etc.</p>
<h1 id="General-Purpose-Input-Output"><a href="#General-Purpose-Input-Output" class="headerlink" title="General Purpose Input&#x2F;Output"></a>General Purpose Input&#x2F;Output</h1><p>For MCU to perform zero and one to compute, the voltage level is used.</p>
<p>The power supply voltage is called V_DD</p>
<h2 id="Input-Signals"><a href="#Input-Signals" class="headerlink" title="Input Signals"></a>Input Signals</h2><p>Digital inputs are interpreted based on their voltage levels, and based on the supply voltage V_DD sets the thresholds for determining whether an input voltage will be considered</p>
<img src="/images/test.jpg">

<p>The grapgh above shows the relationship between input voltage based on V_DD</p>
<p>The range of logical zero will be 0V to 0.35 * V_DD</p>
<p>The range of logical one will be 0.7 * V_DD to V_DD</p>
<p>the input voltage between 0.35 * V_DD to 0.7 * V_DD is undefined, and may be read as one or zero</p>
<p>This is useless so external circuit desined to keep the voltage out of that range except switching</p>
<h2 id="Output-Signals"><a href="#Output-Signals" class="headerlink" title="Output Signals"></a>Output Signals</h2><p>Output voltages for digital ports are typically specified as being within a certain voltage range from a supply rail </p>
<p>For common MCU, the output voltage of logical one V_OH will between V_DD to V_DD - 0.5V</p>
<p>the output voltage of logical zero will between 0 to 0.5V</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/Embedded-System/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Youhuai Liu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blog of Youhuai Liu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Blog of Youhuai Liu">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/Embedded-System/" class="post-title-link" itemprop="url">Embedded_System</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-11-03 15:15:22" itemprop="dateCreated datePublished" datetime="2024-11-03T15:15:22+00:00">2024-11-03</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-11-24 19:53:09" itemprop="dateModified" datetime="2024-11-24T19:53:09+00:00">2024-11-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Embedded-System/" itemprop="url" rel="index"><span itemprop="name">Embedded System</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="GPIO-for-Output"><a href="#GPIO-for-Output" class="headerlink" title="GPIO for Output"></a>GPIO for Output</h1><p>GPIO &#x3D; General-purpose input&#x2F;output</p>
<h2 id="Digital-Output"><a href="#Digital-Output" class="headerlink" title="Digital Output"></a>Digital Output</h2><p>A 1-bit value causes a voltage on a pin</p>
<p>1 for HIGH and 0 for LOW</p>
<h3 id="Active-High"><a href="#Active-High" class="headerlink" title="Active High"></a>Active High</h3><p>When the peripheral is under Active High, it connects to the pin and ground.</p>
<p>So the HIGH will activate and LOW will deactivate it.</p>
<h3 id="Active-Low"><a href="#Active-Low" class="headerlink" title="Active Low"></a>Active Low</h3><p>WHen the Peripheral is under Active Low, it connects to pin and power.</p>
<p>So the HIGH will deactivate and LOW will activate it.</p>
<h1 id="Setting-One-Bit-in-a-Register"><a href="#Setting-One-Bit-in-a-Register" class="headerlink" title="Setting One Bit in a Register"></a>Setting One Bit in a Register</h1><p>If write 0b0010 to DOR which the value is 0b1100, the other bits will be overwritten.</p>
<p>So it needs to write in the way not affect other digits.</p>
<h2 id="Solution-1-Read-Modiry-Write"><a href="#Solution-1-Read-Modiry-Write" class="headerlink" title="Solution 1: Read, Modiry, Write"></a>Solution 1: Read, Modiry, Write</h2><p>E.g </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PTE -&gt; PDDR |= MASK(BLUE_LED_POS);</span><br></pre></td></tr></table></figure>
<p>or equivalent to</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PTE -&gt; PDDR =PTE-&gt;PDDR | MASK(BLUE_LED_POS);</span><br></pre></td></tr></table></figure>

<p>In the mask.h the MASK() defined as</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> MASK(x) (1UL &lt;&lt; (x))</span></span><br></pre></td></tr></table></figure>

<p>1UL means an unsigned long with the value of 1, and based on the x provided, it will shift the digits.</p>
<p>Then it will do OR operation on PTE-&gt;PDDR so that it will not change other value.</p>
<h2 id="Solution-2-Set-Clear-Toggle"><a href="#Solution-2-Set-Clear-Toggle" class="headerlink" title="Solution 2: Set, Clear, Toggle"></a>Solution 2: Set, Clear, Toggle</h2><p>Also, it can use PSOR to write to PDOR. By using PSOR,</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PTE-&gt;PSOR = MASK(BLUE_LED_POS)</span><br></pre></td></tr></table></figure>
<p>PSOR can only write HIGH to specific PDOR, so it will not overwritten the existing value.</p>
<p>However, PSOR cannot write LOW or write to other registers. Also, it can only change 1 digit normally.</p>
<h1 id="Data-Direction-Register"><a href="#Data-Direction-Register" class="headerlink" title="Data Direction Register"></a>Data Direction Register</h1><p>PDDR will decide the direction (Input or Output) of a pin.</p>
<p>LOW will be Input and HIGH will be Output.</p>
<p>To make two pins become output can use</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PTE -&gt; PDDR |= MASK(RED_LED_POS) | MASK(BLUE_LED_MASK);</span><br></pre></td></tr></table></figure>
<p>To clean the bit in PDDR,</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PTE-&gt;PDDR &amp;= ~ MASK(BLUE_LED_POS);</span><br></pre></td></tr></table></figure>
<p>~ stand for bitwise NOT</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/%E3%83%AB%E3%83%BC%E3%82%BF%E3%81%A8%E3%82%B9%E3%82%A4%E3%83%83%E3%83%81%E3%81%AE%E5%9F%BA%E6%9C%AC%E5%8B%95%E4%BD%9C/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Youhuai Liu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blog of Youhuai Liu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Blog of Youhuai Liu">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/%E3%83%AB%E3%83%BC%E3%82%BF%E3%81%A8%E3%82%B9%E3%82%A4%E3%83%83%E3%83%81%E3%81%AE%E5%9F%BA%E6%9C%AC%E5%8B%95%E4%BD%9C/" class="post-title-link" itemprop="url">ルータとスイッチの基本動作</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-09-21 09:22:37" itemprop="dateCreated datePublished" datetime="2024-09-21T09:22:37+01:00">2024-09-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-11-24 19:53:09" itemprop="dateModified" datetime="2024-11-24T19:53:09+00:00">2024-11-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/CCNP/" itemprop="url" rel="index"><span itemprop="name">CCNP</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="スイッチの基本動作"><a href="#スイッチの基本動作" class="headerlink" title="スイッチの基本動作"></a>スイッチの基本動作</h1><h2 id="MACアドレステーブルの管理"><a href="#MACアドレステーブルの管理" class="headerlink" title="MACアドレステーブルの管理"></a>MACアドレステーブルの管理</h2><h3 id="基本的なスイッチの動作"><a href="#基本的なスイッチの動作" class="headerlink" title="基本的なスイッチの動作"></a>基本的なスイッチの動作</h3><p>スイッチでは自身が保持しているMACアドレステーブルを素に転送処理している。</p>
<p>フレームを受信した場合は、以下の手順によって処理される:<br>1．受信したフレームのレイヤ2ヘッダに格納されている送信元MACアドレスを確認し、MACアドレステーブルにエントリが存在しない場合、そのアドレスを自信のMACアドレステーブルに登録する。</p>
<p>2．受信したフレームのレイヤ2ヘッダに格納されている宛先MACアドレスを自身のMACアドレステーブルから該当するエントリを検索し、該当するMACアドレスが存在する場合、対象のポートへ転送する。</p>
<p>もし自身のMACアドレステーブルにエントリが存在しない場合、受信したポート以外の全ポートにフレームを転送処理する（<strong>フラッディング</strong>）</p>
<p>これらの転送の処理をスイッチはデータブレーンという場所で処理している。</p>
<h4 id="コントロールブレーンとデータブレーン"><a href="#コントロールブレーンとデータブレーン" class="headerlink" title="コントロールブレーンとデータブレーン"></a>コントロールブレーンとデータブレーン</h4><p>スイッチには<strong>コントロールブレーン</strong>と<strong>データブレーン</strong>と呼ばれる場所がある。</p>
<p>コントロールブレーンではSTPで使用されるBPDUやARP、ルーティングプロトコルなどの各種通信がCPUやメモリをし応して処理する。（ソフトウェア処理）</p>
<p>データブレーンではレイヤ2やレイヤ3の転送処理やACL、QoSの処理などを行う。ASICという集積回路を使用して、CPUを使わず処理し、ソフトウェア処理より高速。（ハードウェア処理）</p>
<h3 id="MACアドレステーブル"><a href="#MACアドレステーブル" class="headerlink" title="MACアドレステーブル"></a>MACアドレステーブル</h3><p>CatalystスイッチではMACテーブルをCAMテーブルとも呼ぶ。それはMACアドレスがCAMというメモリに格納されているからだ。</p>
<h4 id="CAM"><a href="#CAM" class="headerlink" title="CAM"></a>CAM</h4><p><span style="background-color: #E0FFFF; color : #001f3f"><strong>CAM</strong></span>はContent Addressable Memoryの略で、メモリ内に格納されているビットが完全一致する内容を高速に検索する機能を持ったメモリ。</p>
<p>このメモリをMACアドレステーブルの保存領域として使用し、ASICにより検索することで、転送ポートの決定を高速化している。MACアドレステーブルは通常完全一致するものを探せばいいのでCAMを使うが、機種によってはTCAMが使われる。</p>
<h4 id="TCAM"><a href="#TCAM" class="headerlink" title="TCAM"></a>TCAM</h4><p><span style="background-color: #E0FFFF; color : #001f3f"><strong>TCAM</strong></span>はTernary Content Addressable Memoryの略で、CAM同様、高速に検索するためのメモリ。CAMとの違いは、CAMは完全一致のものを探すのに対し、TCAMは検索対象にビットが0の部分と1の部分、両方でもいい部分の三つの状態を持つことで、部分一致のものを検索する用途として使用される。</p>
<p>例：サブネットマスク、ワイルドカードマスク</p>
<p>ルーティング機能を持つレイヤ3スイッチではACLやルーティングテーブルなどの検索や、QoSの処理などにTCAMが使われる。</p>
<p>スイッチではこれらCAMやTCAMをASICで検索することで、高速に転送処理を行っている。<span style="background-color: #E0FFFF; color : #001f3f">****</span></p>
<h4 id="MACアドレステーブルのエントリ"><a href="#MACアドレステーブルのエントリ" class="headerlink" title="MACアドレステーブルのエントリ"></a>MACアドレステーブルのエントリ</h4><p>CiscoのCatalystスイッチでコマンドにより調べることが出来るMACアドレステーブルには以下の内容が登録されている。</p>
<table>
<thead>
<tr>
<th>項目</th>
<th>内容</th>
</tr>
</thead>
<tbody><tr>
<td>VLAN</td>
<td>所属しているVLAN</td>
</tr>
<tr>
<td>MAC Address</td>
<td>学習したMACアドレス</td>
</tr>
<tr>
<td>Type</td>
<td>登録方法</td>
</tr>
<tr>
<td>Ports</td>
<td>該当するスイッチのポート</td>
</tr>
</tbody></table>
<p>スイッチがフレームを受信するとMACアドレステーブルに完全一致するMACアドレスを探し、見つかれば、Portsで指定されているポートにフレームを転送する。</p>
<p><span style="background-color: #E0FFFF; color : #001f3f"><strong>ただし所属するVLANが違う場合は転送されない</strong></span></p>
<p>受信したフレームの宛先MACアドレスがMACアドレステーブルに登録されていない場合、受信したポートのVLANと<span style="background-color: #E0FFFF; color : #001f3f"><strong>同じVLAN</strong></span>に所属するポート（受信ポート以外）すべてにフラッディングする。</p>
<p>また送信元MACアドレスも確認し、そのMACアドレスが登録されていない場合、新たにMACアドレステーブルのエントリに自動的に追加する。</p>
<p>MACアドレステーブルのエントリは管理者が手動で登録することもでき、<span class="highlight">Type</span>を参照することで判断できる。</p>
<h3 id="MACアドレステーブルのエージング"><a href="#MACアドレステーブルのエージング" class="headerlink" title="MACアドレステーブルのエージング"></a>MACアドレステーブルのエージング</h3><p>CAMやTCAMには上限があり、古いMACアドレスを保持したままだと、新しいMACアドレスを登録できず、新しい宛先絵の通信はフラッディングされ続けます。</p>
<p>なので、MACアドレステーブルには<span class="highlight"><strong>エージング</strong></span>が存在し、MACアドレステーブルの内容をチェックする感覚をエージングタイムという。</p>
<p>そのほかにも管理者が手動で登録内容を削除することもできる。</p>
<h3 id="MACアドレステーブルの管理コマンド"><a href="#MACアドレステーブルの管理コマンド" class="headerlink" title="MACアドレステーブルの管理コマンド"></a>MACアドレステーブルの管理コマンド</h3><h4 id="MACアドレステーブルの確認"><a href="#MACアドレステーブルの確認" class="headerlink" title="MACアドレステーブルの確認"></a>MACアドレステーブルの確認</h4><p>設備に保存されているMACアドレステーブルを確認するには特権EXECモードで</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show mac address-table [dynamic \ static \ address &lt;MACアドレス&gt; \ vlan &lt;vlan番号&gt; \ interface &lt;インターフェイス&gt;]</span><br></pre></td></tr></table></figure>
<p>を実行する</p>
<p>後記のオプション（Dynamic…Interface）を指定せずに実行すると、機器内に作成されてるMACアドレステーブルすべてを確認できる。</p>
<h4 id="MACアドレステーブルの手動登録と削除"><a href="#MACアドレステーブルの手動登録と削除" class="headerlink" title="MACアドレステーブルの手動登録と削除"></a>MACアドレステーブルの手動登録と削除</h4><p>手動でMACアドレステーブルにエントリを登録したい場合はグローバルコンフィギュレーションモードで</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[no] mac address table static &lt;MACアドレス&gt; vlan &lt;VLAN番号&gt; interface &lt;インターフェイス&gt;</span><br></pre></td></tr></table></figure>
<p>MACアドレスに登録したいMACアドレスを指定し、VLAN番号には対応するVLAN番号を、インターフェイスには対応するインターフェイスを指定する。</p>
<p>手動で登録したMACの場合、noを付け加えることで削除する。</p>
<p>自動で登録したMACアドレスを削除する場合は特権EXECモードで</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">clear mac address-table dynamic [address &lt;MACアドレス&gt; \ vlan &lt;vlan番号&gt; \ interface &lt;インターフェイス&gt;]</span><br></pre></td></tr></table></figure>
<p>を実行する。</p>
<p>自動登録されたMACアドレスを削除する場合はオプションを付けず、オプションを付けた場合、指定されたのと関連するエントリを削除する。</p>
<h4 id="MACアドレステーブルのエージングタイムの確認"><a href="#MACアドレステーブルのエージングタイムの確認" class="headerlink" title="MACアドレステーブルのエージングタイムの確認"></a>MACアドレステーブルのエージングタイムの確認</h4><p>機器のMACアドレステーブルのエージングタイムを確認する場合、特権EXECモードで</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show mac address-table aging-time</span><br></pre></td></tr></table></figure>
<p>を実行する。</p>
<h4 id="MACアドレステーブルのエージングタイムの変更"><a href="#MACアドレステーブルのエージングタイムの変更" class="headerlink" title="MACアドレステーブルのエージングタイムの変更"></a>MACアドレステーブルのエージングタイムの変更</h4><p>MACアドレステーブルのエージングタイムを変更するには、グローバルコンフィギュレーションモードで</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mac address-table aging-time &lt;秒数&gt; [vlan &lt;VLAN番号&gt;]</span><br></pre></td></tr></table></figure>
<p>秒数にはエージングの間隔を指定し、０を指定するとエージングが無効になる。</p>
<p>オプションとしてVLAN番号を指定し、対象のVLANだけのエージングタイムを変更することが出来る。</p>
<h2 id="エラーの検出と復旧"><a href="#エラーの検出と復旧" class="headerlink" title="エラーの検出と復旧"></a>エラーの検出と復旧</h2><p>スイッチではポートで特定のエラーを検出すると、そのポートを<span class="highlight"><strong>エラーディセーブル</strong></span>（Errdisable）状態にする。</p>
<p>エラーディセーブルになると、そのポートはデータの送受信が禁止され、エラーによる影響を最低限にし、エラーになった原因をシステムログとして出力する。</p>
<h3 id="エラーディセーブルの原因となるもの"><a href="#エラーディセーブルの原因となるもの" class="headerlink" title="エラーディセーブルの原因となるもの"></a>エラーディセーブルの原因となるもの</h3><p>原因として次のものがある。</p>
<ul>
<li>BPDUガードの違反</li>
<li>EtherChannelの設定ミスによるループ</li>
<li>リンクのフラップの検出</li>
<li>UDLDで単宝庫ぷリンクの検出</li>
<li>ポートセキュリティの違反</li>
</ul>
<p>以外にも、原因となるものは複数存在する。</p>
<h3 id="エラーディセーブルからの復旧"><a href="#エラーディセーブルからの復旧" class="headerlink" title="エラーディセーブルからの復旧"></a>エラーディセーブルからの復旧</h3><p>スイッチでは一度エラーディセーブルとなったポートはデフォルトの設定だと自然に復旧はしない。復旧するには管理者がログインし、手動でコマンド入力するか、自動で一定時間後に有効するように設定する必要がある。</p>
<h4 id="手動で復旧する方法"><a href="#手動で復旧する方法" class="headerlink" title="手動で復旧する方法"></a>手動で復旧する方法</h4><p>手動でポートをエラーディセーブルから有効な状態にするには。そのポートを一度シャットダウンして、再度シャットダウンを解除する。</p>
<h4 id="自動で復旧する方法"><a href="#自動で復旧する方法" class="headerlink" title="自動で復旧する方法"></a>自動で復旧する方法</h4><p>手動以外に、あらかじめ決めた時間が経過した後、自動でエラーディセーブルから有効な状態に戻すことが出来る機能がある。ただしエラー原因が解決されていない場合、自動復旧しても再度エラーディセーブルとなる。</p>
<h3 id="エラー検出の各種設定と確認"><a href="#エラー検出の各種設定と確認" class="headerlink" title="エラー検出の各種設定と確認"></a>エラー検出の各種設定と確認</h3><h4 id="検出するエラーの確認"><a href="#検出するエラーの確認" class="headerlink" title="検出するエラーの確認"></a>検出するエラーの確認</h4><p>現在検出するエラーの原因を確認するには、特権EXECモードで</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show errdisable detect</span><br></pre></td></tr></table></figure>
<p>を実行する。</p>
<h4 id="特定のエラーのみを検出する設定"><a href="#特定のエラーのみを検出する設定" class="headerlink" title="特定のエラーのみを検出する設定"></a>特定のエラーのみを検出する設定</h4><p>特定のエラーのみを検出する場合、グローバルコンフィギュレーションモードで</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[no] errdisable detect cause &lt;エラーの原因&gt;</span><br></pre></td></tr></table></figure>
<p>を実行する。</p>
<p>エラーの原因にエラーとして検出するものを指定でき、Allとすることですべてのエラーを指定することが出来る。</p>
<h4 id="自動復旧させるエラーの確認"><a href="#自動復旧させるエラーの確認" class="headerlink" title="自動復旧させるエラーの確認"></a>自動復旧させるエラーの確認</h4><p>機器で自動復旧するエラーの原因を確認するには、特権EXECモードで</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show errdisable recovery</span><br></pre></td></tr></table></figure>
<p>を実行する。</p>
<h4 id="自動復旧を有効化する設定"><a href="#自動復旧を有効化する設定" class="headerlink" title="自動復旧を有効化する設定"></a>自動復旧を有効化する設定</h4><p>自動でエラーディセーブルから復旧するにはグローバルコンフィギュレーションモードで</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[no] errdisable recovery cause &lt;エラーの原因&gt;</span><br></pre></td></tr></table></figure>
<p>を実行する。</p>
<p>デフォルトでは300sでエラーディセーブルから自動復旧するが、復旧までの秒数を変更したい場合、グローバルコンフィギュレーションモードで</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">errdisable recovery interval &lt;秒数&gt;</span><br></pre></td></tr></table></figure>
<p>を実行する。</p>
<p>秒数は30から86400まで指定可能。</p>
<h2 id="ルーターの基本動作"><a href="#ルーターの基本動作" class="headerlink" title="ルーターの基本動作"></a>ルーターの基本動作</h2><h3 id="パケット転送方式について"><a href="#パケット転送方式について" class="headerlink" title="パケット転送方式について"></a>パケット転送方式について</h3><p>ルーターが受信したパケットを転送する際、まずパケットの宛先IPアドレスを確認する。</p>
<p>受け取ったパケットをルーティングするには、ルーターに保持されている経路情報を検索する必要がある。</p>
<p>経路情報を所持しているデータベースをRIB(Routing Information Base)と呼び、これがルーティングテーブルだ。</p>
<p>ルータはルーティングテーブルからパケットの宛先IPアドレスに該当するエントリを探し、ネクストホップの情報と送信するインターフェイスの情報を取得する。</p>
<p>検索する際ルーティングテーブルにインターフェイス情報が存在しなかった場合、ネクストホップに向かうためのインターフェイスを再検索し、検索が2回行われる。</p>
<p>転送に必要な情報が判明すると、ネクストホップに転送するためにARPテーブルを検索して、ネクストホップのMACアドレスを取得する。</p>
<p>もしMACアドレス情報が存在しなかった場合、ARP要求を送信し、ネクストホップのMACアドレスを取得する。</p>
<p>MACアドレスが判明したらL2ヘッダを書き換え、指定されたインターフェイスからフレームを送信する。</p>
<p>上記によると最大3回検索されるので、短縮するためにプロセススイッチング、ファストスイッチング、CEFなどの方法が考え出された。</p>
<h3 id="プロセススイッチング"><a href="#プロセススイッチング" class="headerlink" title="プロセススイッチング"></a>プロセススイッチング</h3><p>プロセススイッチングはパケットが着信するたびに検索を行う方法で、上記の方法と同様。</p>
<h3 id="ファストスイッチング"><a href="#ファストスイッチング" class="headerlink" title="ファストスイッチング"></a>ファストスイッチング</h3><p>ファストスイッチングは、初めて転送する宛先にはプロセススイッチングと同様の動作を行い、フレームが送信される。</p>
<p>プロセススイッチングとの違いは最初の転送処理する際に判明した転送に必要な情報を高速に検索できるキャッシュに保存する。</p>
<p>以降この宛先への検索はキャッシュを利用する。</p>
<h3 id="ルータの内部構造"><a href="#ルータの内部構造" class="headerlink" title="ルータの内部構造"></a>ルータの内部構造</h3><p>ルータやスイッチの機能は大きく分けて３つのコンポーネントになり、コントロールブレーン、データブレーン、バックブレーンの３つに分類される。</p>
<h3 id="コントロールプレーン"><a href="#コントロールプレーン" class="headerlink" title="コントロールプレーン"></a>コントロールプレーン</h3><p>コントロールプレーンはCPU処理によりデバイス全体の制御を行う。<br>他にもパケット転送に必須なルーティングテーブルやMACアドレステーブルなどの経路情報を作成／制御する役割を担う。<br>また、ルータ宛のパケットの処理を行う。</p>
<p>プロセススイッチングによるパケットの転送はすべてコントロールプレーン上で処理される。CPUによるソフトウェア処理を行うため、処理速度も遅く、CPUの負荷が大きくなる。</p>
<h3 id="データプレーン"><a href="#データプレーン" class="headerlink" title="データプレーン"></a>データプレーン</h3><p>データプレーンは、ネットワーク機器がパケットの転送処理を行う部分。</p>
<p>転送のほかに、パケってのカプセル化やACLによるフィルタリング、パケット転送の際に必要な処理はすべてデータプレーンで実行される。</p>
<p>ファストスイッチングで使用されるキャッシュはデータプレーン上で作成される。</p>
<p>CEFはデータプレーンだけを使って転送処理するので、ファストスイッチングよりさらに高速で転送処理ができる。</p>
<h3 id="バックブレーン"><a href="#バックブレーン" class="headerlink" title="バックブレーン"></a>バックブレーン</h3><p>バックブレーンは受信したパケットを受信インターフェイスから送信インターフェイスへ運ぶ役割を担う。</p>
<h3 id="CEFの概要"><a href="#CEFの概要" class="headerlink" title="CEFの概要"></a>CEFの概要</h3><p>ファストスイッチングでは、キャッシュ内に該当するエントリが存在しないパケットが大量に届いた場合、その都度プロセススイッチングする必要があり、効率が下がる。</p>
<p>CEF(Cisco Express Forwarding)ではプロセススイッチングを行わず、ルーティングテーブルからあらかじFIB(Forward Information Base)というテーブルを作成する。またARPテーブルからは隣接テーブル(Adjacency Table)を作成する。そしてこの２つのテーブルを紐づける。</p>
<p><span class="highlight">****</span></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>





</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Youhuai Liu</span>
  </div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  






  





</body>
</html>
